192.168.33.135 -----> Installing Chef Omnibus (-v 12)
192.168.33.135 downloading https://omnitruck-direct.chef.io/chef/install.sh
192.168.33.135   to file /tmp/install.sh.23159/install.sh
192.168.33.135 trying wget...
192.168.33.135 el 6 x86_64
192.168.33.135 Getting information for chef stable 12 for el...
192.168.33.135 downloading https://omnitruck-direct.chef.io/stable/chef/metadata?v=12&p=el&pv=6&m=x86_64
192.168.33.135   to file /tmp/install.sh.23166/metadata.txt
192.168.33.135 trying wget...
192.168.33.135 sha1	9e4078002ffb604f29ac0fdc92c5a8a13e4e3491
192.168.33.135 sha256	78722816dd421fc8bae538fe559c37a59d5fd09c833cd4c97e577c59ecd5bc0f
192.168.33.135 url	https://packages.chef.io/stable/el/6/chef-12.14.60-1.el6.x86_64.rpm
192.168.33.135 version	12.14.60
192.168.33.135 downloaded metadata file looks valid...
192.168.33.135 downloading https://packages.chef.io/stable/el/6/chef-12.14.60-1.el6.x86_64.rpm
192.168.33.135   to file /tmp/install.sh.23166/chef-12.14.60-1.el6.x86_64.rpm
192.168.33.135 trying wget...
192.168.33.135 Comparing checksum with sha256sum...
192.168.33.135 Installing chef 12
192.168.33.135 installing with rpm...
192.168.33.135 warning: /tmp/install.sh.23166/chef-12.14.60-1.el6.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 83ef826a: NOKEY
192.168.33.135 Preparing...                                                            (100%)#                                           (100%)##                                          (100%)###                                         (100%)####                                        (100%)#####                                       (100%)######                                      (100%)#######                                     (100%)########                                    (100%)#########                                   (100%)##########                                  (100%)###########                                 (100%)############                                (100%)#############                               (100%)##############                              (100%)###############                             (100%)################                            (100%)#################                           (100%)##################                          (100%)###################                         (100%)####################                        (100%)#####################                       (100%)######################                      (100%)#######################                     (100%)########################                    (100%)#########################                   (100%)##########################                  (100%)###########################                 (100%)############################                (100%)#############################               (100%)##############################              (100%)###############################             (100%)################################            (100%)#################################           (100%)##################################          (100%)###################################         (100%)####################################        (100%)#####################################       (100%)######################################      (100%)#######################################     (100%)########################################    (100%)#########################################   (100%)##########################################  (100%)########################################### (100%)########################################### [100%]
192.168.33.135    1:chef                                                               (  1%)#                                           (  3%)##                                          (  6%)###                                         (  8%)####                                        ( 10%)#####                                       ( 13%)######                                      ( 15%)#######                                     ( 17%)########                                    ( 19%)#########                                   ( 22%)##########                                  ( 24%)###########                                 ( 26%)############                                ( 28%)#############                               ( 31%)##############                              ( 33%)###############                             ( 35%)################                            ( 38%)#################                           ( 40%)##################                          ( 42%)###################                         ( 44%)####################                        ( 47%)#####################                       ( 49%)######################                      ( 51%)#######################                     ( 53%)########################                    ( 56%)#########################                   ( 58%)##########################                  ( 60%)###########################                 ( 63%)############################                ( 65%)#############################               ( 67%)##############################              ( 69%)###############################             ( 72%)################################            ( 74%)#################################           ( 76%)##################################          ( 78%)###################################         ( 81%)####################################        ( 83%)#####################################       ( 85%)######################################      ( 88%)#######################################     ( 90%)########################################    ( 92%)#########################################   ( 94%)##########################################  ( 97%)########################################### ( 99%)########################################### [100%]
192.168.33.135 Thank you for installing Chef!
192.168.33.135 Starting the first Chef Client run...
192.168.33.135 Starting Chef Client, version 12.14.60[0m
192.168.33.135 resolving cookbooks for run list: ["jboss"][0m
192.168.33.135 Synchronizing Cookbooks:[0m
192.168.33.135   - jboss (1.0.0)[0m
192.168.33.135   - java (1.42.0)[0m
192.168.33.135   - apt (4.0.2)[0m
192.168.33.135   - compat_resource (12.14.3)[0m
192.168.33.135   - windows (2.0.2)[0m
192.168.33.135   - homebrew (2.1.2)[0m
192.168.33.135   - build-essential (6.0.5)[0m
192.168.33.135   - seven_zip (2.0.2)[0m
192.168.33.135   - mingw (1.2.4)[0m
192.168.33.135 Installing Cookbook Gems:[0m
192.168.33.135 Compiling Cookbooks...[0m
192.168.33.135 [2016-09-15T15:38:47+00:00] WARN: Chef::Provider::AptRepository already exists!  Cannot create deprecation class for LWRP provider apt_repository from cookbook apt
192.168.33.135 [2016-09-15T15:38:47+00:00] WARN: AptRepository already exists!  Deprecation class overwrites Custom resource apt_repository from cookbook apt
192.168.33.135 Converging 19 resources[0m
192.168.33.135 Recipe: java::notify[0m
192.168.33.135   * log[jdk-version-changed] action nothing (skipped due to action :nothing)
192.168.33.135 Recipe: java::set_java_home[0m
192.168.33.135   * ruby_block[set-env-java-home] action run
192.168.33.135     [32m- execute the ruby block set-env-java-home[0m
192.168.33.135 [0m  * directory[/etc/profile.d] action create (up to date)
192.168.33.135   * template[/etc/profile.d/jdk.sh] action create
192.168.33.135     [32m- create new file /etc/profile.d/jdk.sh[0m
192.168.33.135     [32m- update content in file /etc/profile.d/jdk.sh from none to 5b75c4[0m
192.168.33.135     [37m--- /etc/profile.d/jdk.sh	2016-09-15 15:38:47.454663000 +0000[0m
192.168.33.135     [37m+++ /etc/profile.d/.chef-jdk.sh20160915-23237-1wb5r6f	2016-09-15 15:38:47.454663000 +0000[0m
192.168.33.135     [37m@@ -1 +1,2 @@[0m
192.168.33.135     [37m+export JAVA_HOME=/usr/lib/jvm/java[0m
192.168.33.135     [32m- change mode from '' to '0755'[0m
192.168.33.135     [32m- restore selinux security context[0m
192.168.33.135 [0mRecipe: java::oracle[0m
192.168.33.135   * yum_package[tar] action install (up to date)
192.168.33.135   * java_ark[jdk] action install
192.168.33.135     [32m- create dir /usr/lib/jvm and change owner to root:root[0m
192.168.33.135     * yum_package[curl] action install (up to date)
192.168.33.135     [32m- download oracle tarball straight from the server[0m
192.168.33.135     [32m- extract compressed data into Chef file cache path and
192.168.33.135 [0m    [32m                    move extracted data to /usr/lib/jvm/jdk1.6.0_45[0m
192.168.33.135     [32m- Symlink /usr/lib/jvm/jdk1.6.0_45 to /usr/lib/jvm/java[0m
192.168.33.135 [0mRecipe: java::notify[0m
192.168.33.135   * log[jdk-version-changed] action write
192.168.33.135   
192.168.33.135 [0m  * yum_package[curl] action nothing (skipped due to action :nothing)
192.168.33.135   * java_alternatives[set-java-alternatives] action set
192.168.33.135     [32m- Add alternative for appletviewer[0m
192.168.33.135     [32m- Add alternative for apt[0m
192.168.33.135     [32m- Add alternative for ControlPanel[0m
192.168.33.135     [32m- Add alternative for extcheck[0m
192.168.33.135     [32m- Add alternative for HtmlConverter[0m
192.168.33.135     [32m- Add alternative for idlj[0m
192.168.33.135     [32m- Add alternative for jar[0m
192.168.33.135     [32m- Add alternative for jarsigner[0m
192.168.33.135     [32m- Add alternative for java[0m
192.168.33.135     [32m- Add alternative for javac[0m
192.168.33.135     [32m- Add alternative for javadoc[0m
192.168.33.135     [32m- Add alternative for javah[0m
192.168.33.135     [32m- Add alternative for javap[0m
192.168.33.135     [32m- Add alternative for javaws[0m
192.168.33.135     [32m- Add alternative for jconsole[0m
192.168.33.135     [32m- Add alternative for jcontrol[0m
192.168.33.135     [32m- Add alternative for jdb[0m
192.168.33.135     [32m- Add alternative for jhat[0m
192.168.33.135     [32m- Add alternative for jinfo[0m
192.168.33.135     [32m- Add alternative for jmap[0m
192.168.33.135     [32m- Add alternative for jps[0m
192.168.33.135     [32m- Add alternative for jrunscript[0m
192.168.33.135     [32m- Add alternative for jsadebugd[0m
192.168.33.135     [32m- Add alternative for jstack[0m
192.168.33.135     [32m- Add alternative for jstat[0m
192.168.33.135     [32m- Add alternative for jstatd[0m
192.168.33.135     [32m- Add alternative for jvisualvm[0m
192.168.33.135     [32m- Add alternative for keytool[0m
192.168.33.135     [32m- Add alternative for native2ascii[0m
192.168.33.135     [32m- Add alternative for orbd[0m
192.168.33.135     [32m- Add alternative for pack200[0m
192.168.33.135     [32m- Add alternative for policytool[0m
192.168.33.135     [32m- Add alternative for rmic[0m
192.168.33.135     [32m- Add alternative for rmid[0m
192.168.33.135     [32m- Add alternative for rmiregistry[0m
192.168.33.135     [32m- Add alternative for schemagen[0m
192.168.33.135     [32m- Add alternative for serialver[0m
192.168.33.135     [32m- Add alternative for servertool[0m
192.168.33.135     [32m- Add alternative for tnameserv[0m
192.168.33.135     [32m- Add alternative for unpack200[0m
192.168.33.135     [32m- Add alternative for wsgen[0m
192.168.33.135     [32m- Add alternative for wsimport[0m
192.168.33.135     [32m- Add alternative for xjc[0m
192.168.33.135 [0mRecipe: jboss::default[0m
192.168.33.135   * yum_package[unzip] action install (up to date)
192.168.33.135   * linux_user[jboss] action create
192.168.33.135     [32m- create user jboss[0m
192.168.33.135 [0m  * group[jboss] action create (up to date)
192.168.33.135   * remote_file[/tmp/jboss-as-distribution-6.1.0.Final.zip] action create
192.168.33.135     [32m- create new file /tmp/jboss-as-distribution-6.1.0.Final.zip[0m
192.168.33.135     [32m- update content in file /tmp/jboss-as-distribution-6.1.0.Final.zip from none to 3426fd[0m
192.168.33.135     [37m(file sizes exceed 10000000 bytes, diff output suppressed)[0m
192.168.33.135     [32m- change mode from '' to '0755'[0m
192.168.33.135     [32m- change owner from '' to 'jboss'[0m
192.168.33.135     [32m- change group from '' to 'jboss'[0m
192.168.33.135     [32m- restore selinux security context[0m
192.168.33.135 [0m  * execute[unzip_jboss] action run
192.168.33.135     [32m- execute unzip jboss-as-distribution-6.1.0.Final.zip -d /opt[0m
192.168.33.135 [0m  * remote_file[/tmp/hudson.zip] action create
192.168.33.135     [32m- create new file /tmp/hudson.zip[0m
192.168.33.135     [32m- update content in file /tmp/hudson.zip from none to b54a7a[0m
192.168.33.135     [37m(file sizes exceed 10000000 bytes, diff output suppressed)[0m
192.168.33.135     [32m- change mode from '' to '0755'[0m
192.168.33.135     [32m- change owner from '' to 'jboss'[0m
192.168.33.135     [32m- change group from '' to 'jboss'[0m
192.168.33.135     [32m- restore selinux security context[0m
192.168.33.135 [0m  * execute[unzip_app] action run
192.168.33.135     [32m- execute unzip hudson.zip -d /opt/jboss-6.1.0.Final/server/default/deploy[0m
192.168.33.135 [0m  * template[/opt/jboss-6.1.0.Final/server/default/deploy/hudson/hudson.xml] action create
192.168.33.135     [32m- update content in file /opt/jboss-6.1.0.Final/server/default/deploy/hudson/hudson.xml from 0bed72 to 506129[0m
192.168.33.135     [37m--- /opt/jboss-6.1.0.Final/server/default/deploy/hudson/hudson.xml	2014-01-16 15:35:44.000000000 +0000[0m
192.168.33.135     [37m+++ /opt/jboss-6.1.0.Final/server/default/deploy/hudson/.chef-hudson.xml20160915-23237-1pjfuts	2016-09-15 15:41:48.577206193 +0000[0m
192.168.33.135     [37m@@ -12,13 +12,10 @@[0m
192.168.33.135     [37m  <services>[0m
192.168.33.135     [37m     <framework>[0m
192.168.33.135     [37m       <type>Java EE</type>[0m
192.168.33.135     [37m-       <engine>Tomcat-7.0.12</engine>[0m
192.168.33.135     [37m+       <engine>jboss-6.1.0.Final</engine>[0m
192.168.33.135     [37m       <no-of-nodes>1</no-of-nodes>[0m
192.168.33.135     [37m       <max-nodes>2</max-nodes>[0m
192.168.33.135     [37m     </framework>[0m
192.168.33.135     [37m-    <elastic-load-balancer>[0m
192.168.33.135     [37m-      <engine>Nginx-1.2</engine>[0m
192.168.33.135     [37m-    </elastic-load-balancer>[0m
192.168.33.135     [37m   </services>[0m
192.168.33.135     [37m </cumulogic-app>[0m
192.168.33.135     [32m- change mode from '0644' to '0755'[0m
192.168.33.135     [32m- change owner from 'root' to 'jboss'[0m
192.168.33.135     [32m- change group from 'root' to 'jboss'[0m
192.168.33.135     [32m- restore selinux security context[0m
192.168.33.135 [0m  * template[/opt/jboss-6.1.0.Final/bin/run.sh] action create
192.168.33.135     [32m- update content in file /opt/jboss-6.1.0.Final/bin/run.sh from b456ce to ac7bee[0m
192.168.33.135     [37m--- /opt/jboss-6.1.0.Final/bin/run.sh	2011-08-16 08:47:54.000000000 +0000[0m
192.168.33.135     [37m+++ /opt/jboss-6.1.0.Final/bin/.chef-run.sh20160915-23237-9w3vl3	2016-09-15 15:41:48.687207478 +0000[0m
192.168.33.135     [37m@@ -5,23 +5,11 @@[0m
192.168.33.135     [37m ##                                                                          ##[0m
192.168.33.135     [37m ### ====================================================================== ###[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m-### $Id: run.sh 111395 2011-05-18 07:45:07Z beve $ ###[0m
192.168.33.135     [37m+### $Id: run.sh 88978 2009-05-16 18:18:45Z alex.loubyansky@jboss.com $ ###[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m-# Extract the directory and the program name[0m
192.168.33.135     [37m-# takes care of symlinks[0m
192.168.33.135     [37m-PRG="$0"[0m
192.168.33.135     [37m-while [ -h "$PRG" ] ; do[0m
192.168.33.135     [37m-  ls=`ls -ld "$PRG"`[0m
192.168.33.135     [37m-  link=`expr "$ls" : '.*-> \(.*\)$'`[0m
192.168.33.135     [37m-  if expr "$link" : '/.*' > /dev/null; then[0m
192.168.33.135     [37m-    PRG="$link"[0m
192.168.33.135     [37m-  else[0m
192.168.33.135     [37m-    PRG="`dirname "$PRG"`/$link"[0m
192.168.33.135     [37m-  fi[0m
192.168.33.135     [37m-done[0m
192.168.33.135     [37m-DIRNAME=`dirname "$PRG"`[0m
192.168.33.135     [37m-PROGNAME=`basename "$PRG"`[0m
192.168.33.135     [37m-[0m
192.168.33.135     [37m+export JAVA_HOME=/usr/lib/jvm/java[0m
192.168.33.135     [37m+DIRNAME=`dirname $0`[0m
192.168.33.135     [37m+PROGNAME=`basename $0`[0m
192.168.33.135     [37m GREP="grep"[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m # Use the maximum available, or set MAX_FD != -1 to use that[0m
192.168.33.135     [37m@@ -54,7 +42,7 @@[0m
192.168.33.135     [37m     Darwin*)[0m
192.168.33.135     [37m         darwin=true[0m
192.168.33.135     [37m         ;;[0m
192.168.33.135     [37m-[0m
192.168.33.135     [37m+        [0m
192.168.33.135     [37m     Linux)[0m
192.168.33.135     [37m         linux=true[0m
192.168.33.135     [37m         ;;[0m
192.168.33.135     [37m@@ -99,39 +87,44 @@[0m
192.168.33.135     [37m             MAX_FD_LIMIT=`/usr/sbin/sysctl -n kern.maxfilesperproc`[0m
192.168.33.135     [37m         fi[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m-    if [ "$MAX_FD" = "maximum" -o "$MAX_FD" = "max" ]; then[0m
192.168.33.135     [37m-        # use the system max[0m
192.168.33.135     [37m-        MAX_FD="$MAX_FD_LIMIT"[0m
192.168.33.135     [37m-    fi[0m
192.168.33.135     [37m+	if [ "$MAX_FD" = "maximum" -o "$MAX_FD" = "max" ]; then[0m
192.168.33.135     [37m+	    # use the system max[0m
192.168.33.135     [37m+	    MAX_FD="$MAX_FD_LIMIT"[0m
192.168.33.135     [37m+	fi[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m-    ulimit -n $MAX_FD[0m
192.168.33.135     [37m-    if [ "$?" -ne 0 ]; then[0m
192.168.33.135     [37m-        warn "Could not set maximum file descriptor limit: $MAX_FD"[0m
192.168.33.135     [37m-    fi[0m
192.168.33.135     [37m+	ulimit -n $MAX_FD[0m
192.168.33.135     [37m+	if [ "$?" -ne 0 ]; then[0m
192.168.33.135     [37m+	    warn "Could not set maximum file descriptor limit: $MAX_FD"[0m
192.168.33.135     [37m+	fi[0m
192.168.33.135     [37m     else[0m
192.168.33.135     [37m-        warn "Could not query system maximum file descriptor limit: $MAX_FD_LIMIT"[0m
192.168.33.135     [37m+	warn "Could not query system maximum file descriptor limit: $MAX_FD_LIMIT"[0m
192.168.33.135     [37m     fi[0m
192.168.33.135     [37m fi[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m # Setup the JVM[0m
192.168.33.135     [37m if [ "x$JAVA" = "x" ]; then[0m
192.168.33.135     [37m     if [ "x$JAVA_HOME" != "x" ]; then[0m
192.168.33.135     [37m-        JAVA="$JAVA_HOME/bin/java"[0m
192.168.33.135     [37m+	JAVA="$JAVA_HOME/bin/java"[0m
192.168.33.135     [37m     else[0m
192.168.33.135     [37m-        JAVA="java"[0m
192.168.33.135     [37m+	JAVA="java"[0m
192.168.33.135     [37m     fi[0m
192.168.33.135     [37m fi[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m # Setup the classpath[0m
192.168.33.135     [37m-JBOSS_BOOT_CLASSPATH="$JBOSS_HOME/bin/run.jar"[0m
192.168.33.135     [37m-if [ ! -f "$JBOSS_BOOT_CLASSPATH" ]; then[0m
192.168.33.135     [37m-    die "Missing required file: $JBOSS_BOOT_CLASSPATH"[0m
192.168.33.135     [37m+runjar="$JBOSS_HOME/bin/run.jar"[0m
192.168.33.135     [37m+if [ ! -f "$runjar" ]; then[0m
192.168.33.135     [37m+    die "Missing required file: $runjar"[0m
192.168.33.135     [37m fi[0m
192.168.33.135     [37m+JBOSS_BOOT_CLASSPATH="$runjar"[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m # Tomcat uses the JDT Compiler[0m
192.168.33.135     [37m # Only include tools.jar if someone wants to use the JDK instead.[0m
192.168.33.135     [37m # compatible distribution which JAVA_HOME points to[0m
192.168.33.135     [37m-JAVAC_JAR_FILE="${JAVAC_JAR:-$JAVA_HOME/lib/tools.jar}"[0m
192.168.33.135     [37m+if [ "x$JAVAC_JAR" = "x" ]; then[0m
192.168.33.135     [37m+    JAVAC_JAR_FILE="$JAVA_HOME/lib/tools.jar"[0m
192.168.33.135     [37m+else[0m
192.168.33.135     [37m+    JAVAC_JAR_FILE="$JAVAC_JAR"[0m
192.168.33.135     [37m+fi[0m
192.168.33.135     [37m if [ ! -f "$JAVAC_JAR_FILE" ]; then[0m
192.168.33.135     [37m    # MacOSX does not have a seperate tools.jar[0m
192.168.33.135     [37m    if [ "$darwin" != "true" -a "x$JAVAC_JAR" != "x" ]; then[0m
192.168.33.135     [37m@@ -141,83 +134,101 @@[0m
192.168.33.135     [37m    JAVAC_JAR_FILE=[0m
192.168.33.135     [37m fi[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m-# Setup classpath [0m
192.168.33.135     [37m-JBOSS_CLASSPATH="${JBOSS_CLASSPATH:+$JBOSS_CLASSPATH:$JBOSS_BOOT_CLASSPATH}"[0m
192.168.33.135     [37m-JBOSS_CLASSPATH="${JBOSS_CLASSPATH:-$JBOSS_BOOT_CLASSPATH}"[0m
192.168.33.135     [37m-JBOSS_CLASSPATH="$JBOSS_CLASSPATH${JAVAC_JAR_FILE:+:$JAVAC_JAR_FILE}"[0m
192.168.33.135     [37m+if [ "x$JBOSS_CLASSPATH" = "x" ]; then[0m
192.168.33.135     [37m+    JBOSS_CLASSPATH="$JBOSS_BOOT_CLASSPATH"[0m
192.168.33.135     [37m+else[0m
192.168.33.135     [37m+    JBOSS_CLASSPATH="$JBOSS_CLASSPATH:$JBOSS_BOOT_CLASSPATH"[0m
192.168.33.135     [37m+fi[0m
192.168.33.135     [37m+if [ "x$JAVAC_JAR_FILE" != "x" ]; then[0m
192.168.33.135     [37m+    JBOSS_CLASSPATH="$JBOSS_CLASSPATH:$JAVAC_JAR_FILE"[0m
192.168.33.135     [37m+fi[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m-# Check for -d32/-d64 in JAVA_OPTS[0m
192.168.33.135     [37m-JVM_OPTVERSION="-version"[0m
192.168.33.135     [37m-JVM_D64_OPTION=`echo $JAVA_OPTS | $GREP "\-d64"`[0m
192.168.33.135     [37m-JVM_D32_OPTION=`echo $JAVA_OPTS | $GREP "\-d32"`[0m
192.168.33.135     [37m-test "x$JVM_D64_OPTION" != "x" && JVM_OPTVERSION="-d64 $JVM_OPTVERSION"[0m
192.168.33.135     [37m-test "x$JVM_D32_OPTION" != "x" && JVM_OPTVERSION="-d32 $JVM_OPTVERSION"[0m
192.168.33.135     [37m-[0m
192.168.33.135     [37m # If -server not set in JAVA_OPTS, set it, if supported[0m
192.168.33.135     [37m SERVER_SET=`echo $JAVA_OPTS | $GREP "\-server"`[0m
192.168.33.135     [37m if [ "x$SERVER_SET" = "x" ]; then[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m     # Check for SUN(tm) JVM w/ HotSpot support[0m
192.168.33.135     [37m     if [ "x$HAS_HOTSPOT" = "x" ]; then[0m
192.168.33.135     [37m-        HAS_HOTSPOT=`"$JAVA" $JVM_OPTVERSION -version 2>&1 | $GREP -i HotSpot`[0m
192.168.33.135     [37m+	HAS_HOTSPOT=`"$JAVA" -version 2>&1 | $GREP -i HotSpot`[0m
192.168.33.135     [37m     fi[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m-    # Check for OpenJDK JVM w/server support[0m
192.168.33.135     [37m-    if [ "x$HAS_OPENJDK_" = "x" ]; then[0m
192.168.33.135     [37m-        HAS_OPENJDK=`"$JAVA" $JVM_OPTVERSION 2>&1 | $GREP -i OpenJDK`[0m
192.168.33.135     [37m+    # Enable -server if we have Hotspot, unless we can't[0m
192.168.33.135     [37m+    if [ "x$HAS_HOTSPOT" != "x" ]; then[0m
192.168.33.135     [37m+	# MacOS does not support -server flag[0m
192.168.33.135     [37m+	if [ "$darwin" != "true" ]; then[0m
192.168.33.135     [37m+	    JAVA_OPTS="-server $JAVA_OPTS"[0m
192.168.33.135     [37m+	fi[0m
192.168.33.135     [37m     fi[0m
192.168.33.135     [37m-[0m
192.168.33.135     [37m-    # Enable -server if we have Hotspot or OpenJDK, unless we can't[0m
192.168.33.135     [37m-    if [ "x$HAS_HOTSPOT" != "x" -o "x$HAS_OPENJDK" != "x" ]; then[0m
192.168.33.135     [37m-        # MacOS does not support -server flag[0m
192.168.33.135     [37m-        if [ "$darwin" != "true" ]; then[0m
192.168.33.135     [37m-            JAVA_OPTS="-server $JAVA_OPTS"[0m
192.168.33.135     [37m-            JVM_OPTVERSION="-server $JVM_OPTVERSION"[0m
192.168.33.135     [37m-        fi[0m
192.168.33.135     [37m-    fi[0m
192.168.33.135     [37m-else[0m
192.168.33.135     [37m-    JVM_OPTVERSION="-server $JVM_OPTVERSION"[0m
192.168.33.135     [37m fi[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m-# Setup JBoss specific properties[0m
192.168.33.135     [37m-JAVA_OPTS="${JAVA_OPTS:+$JAVA_OPTS -Dprogram.name=$PROGNAME}"[0m
192.168.33.135     [37m-JAVA_OPTS="${JAVA_OPTS:--Dprogram.name=$PROGNAME}"[0m
192.168.33.135     [37m-JAVA_OPTS="${JAVA_OPTS:+$JAVA_OPTS -Dlogging.configuration=file:${DIRNAME}/logging.properties}"[0m
192.168.33.135     [37m-[0m
192.168.33.135     [37m # Setup JBoss Native library path[0m
192.168.33.135     [37m+# Use the common JBoss Native convention[0m
192.168.33.135     [37m+# for packing platform binaries[0m
192.168.33.135     [37m #[0m
192.168.33.135     [37m-if [ -d "$JBOSS_HOME/../native/lib" ]; then[0m
192.168.33.135     [37m-    JBOSS_NATIVE_DIR=`cd "$JBOSS_HOME/../native" && pwd`[0m
192.168.33.135     [37m-elif [ -d "$JBOSS_HOME/native/lib" ]; then[0m
192.168.33.135     [37m-    JBOSS_NATIVE_DIR=`cd "$JBOSS_HOME/native" && pwd`[0m
192.168.33.135     [37m-elif [ -d "$JBOSS_HOME/../native/lib64" ]; then[0m
192.168.33.135     [37m-    JBOSS_NATIVE_DIR=`cd "$JBOSS_HOME/../native" && pwd`[0m
192.168.33.135     [37m-elif [ -d "$JBOSS_HOME/native/lib64" ]; then[0m
192.168.33.135     [37m-    JBOSS_NATIVE_DIR=`cd "$JBOSS_HOME/native" && pwd`[0m
192.168.33.135     [37m-elif [ -d "$JBOSS_HOME/native/bin" ]; then[0m
192.168.33.135     [37m-    JBOSS_NATIVE_DIR=`cd "$JBOSS_HOME/native" && pwd`[0m
192.168.33.135     [37m-elif [ -d "$JBOSS_HOME/bin/native" ]; then[0m
192.168.33.135     [37m-    JBOSS_NATIVE_DIR=`cd "$JBOSS_HOME/bin/native" && pwd`[0m
192.168.33.135     [37m-fi[0m
192.168.33.135     [37m+JBOSS_NATIVE_CPU=`uname -m`[0m
192.168.33.135     [37m+case "$JBOSS_NATIVE_CPU" in[0m
192.168.33.135     [37m+  sun4u*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_CPU="sparcv9"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+  i86pc*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_CPU="x86"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+  i[3-6]86*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_CPU="x86"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+  x86_64*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_CPU="x64"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+  ia64*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_CPU="i64"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+  9000/800*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_CPU="parisc2"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+  Power*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_CPU="ppc"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+esac[0m
192.168.33.135     [37m+[0m
192.168.33.135     [37m+JBOSS_NATIVE_SYS=`uname -s`[0m
192.168.33.135     [37m+case "$JBOSS_NATIVE_SYS" in[0m
192.168.33.135     [37m+  Linux*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_SYS="linux2"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+  SunOS*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_SYS="solaris"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+  HP-UX*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_SYS="hpux"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+  CYGWIN*)[0m
192.168.33.135     [37m+    JBOSS_NATIVE_SYS="windows"[0m
192.168.33.135     [37m+  ;;[0m
192.168.33.135     [37m+esac[0m
192.168.33.135     [37m+[0m
192.168.33.135     [37m+JBOSS_NATIVE_DIR="$JBOSS_HOME/bin/META-INF/lib/$JBOSS_NATIVE_SYS/$JBOSS_NATIVE_CPU"[0m
192.168.33.135     [37m if [ -d "$JBOSS_NATIVE_DIR" ]; then[0m
192.168.33.135     [37m-    if $cygwin; then[0m
192.168.33.135     [37m-        JBOSS_NATIVE_DIR="$JBOSS_NATIVE_DIR/bin"[0m
192.168.33.135     [37m+    if $cygwin ; then[0m
192.168.33.135     [37m         export PATH="$JBOSS_NATIVE_DIR:$PATH"[0m
192.168.33.135     [37m-        JBOSS_NATIVE_LIBPATH=`cygpath --path --windows "$JBOSS_NATIVE_DIR"`[0m
192.168.33.135     [37m+        JBOSS_NATIVE_DIR=`cygpath --path --windows "$JBOSS_NATIVE_DIR"`[0m
192.168.33.135     [37m     else[0m
192.168.33.135     [37m-        IS_64_BIT_JVM=`"$JAVA" $JVM_OPTVERSION 2>&1 | $GREP -i 64-bit`[0m
192.168.33.135     [37m-        if [ "x$IS_64_BIT_JVM" != "x" ]; then[0m
192.168.33.135     [37m-            JBOSS_NATIVE_DIR="$JBOSS_NATIVE_DIR/lib64"[0m
192.168.33.135     [37m+        if [ "x$LD_LIBRARY_PATH" = "x" ]; then[0m
192.168.33.135     [37m+          LD_LIBRARY_PATH="$JBOSS_NATIVE_DIR"[0m
192.168.33.135     [37m         else[0m
192.168.33.135     [37m-            JBOSS_NATIVE_DIR="$JBOSS_NATIVE_DIR/lib"[0m
192.168.33.135     [37m+          LD_LIBRARY_PATH="$JBOSS_NATIVE_DIR:$LD_LIBRARY_PATH"[0m
192.168.33.135     [37m         fi[0m
192.168.33.135     [37m-        LD_LIBRARY_PATH="$JBOSS_NATIVE_DIR${LD_LIBRARY_PATH:+:$LD_LIBRARY_PATH}"[0m
192.168.33.135     [37m         export LD_LIBRARY_PATH[0m
192.168.33.135     [37m-        JBOSS_NATIVE_LIBPATH=$LD_LIBRARY_PATH[0m
192.168.33.135     [37m     fi[0m
192.168.33.135     [37m-    JAVA_OPTS="$JAVA_OPTS -Djava.library.path=$JBOSS_NATIVE_LIBPATH"[0m
192.168.33.135     [37m+    if [ "x$JAVA_OPTS" = "x" ]; then[0m
192.168.33.135     [37m+        JAVA_OPTS="-Djava.library.path=$JBOSS_NATIVE_DIR"[0m
192.168.33.135     [37m+    else[0m
192.168.33.135     [37m+        JAVA_OPTS="$JAVA_OPTS -Djava.library.path=$JBOSS_NATIVE_DIR"[0m
192.168.33.135     [37m+    fi[0m
192.168.33.135     [37m fi[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m+# Setup JBoss specific properties[0m
192.168.33.135     [37m+JAVA_OPTS="-Dprogram.name=$PROGNAME $JAVA_OPTS"[0m
192.168.33.135     [37m+[0m
192.168.33.135     [37m # Setup the java endorsed dirs[0m
192.168.33.135     [37m JBOSS_ENDORSED_DIRS="$JBOSS_HOME/lib/endorsed"[0m
192.168.33.135     [37m [0m
192.168.33.135     [37m@@ -248,17 +259,17 @@[0m
192.168.33.135     [37m while true; do[0m
192.168.33.135     [37m    if [ "x$LAUNCH_JBOSS_IN_BACKGROUND" = "x" ]; then[0m
192.168.33.135     [37m       # Execute the JVM in the foreground[0m
192.168.33.135     [37m-      eval \"$JAVA\" $JAVA_OPTS \[0m
192.168.33.135     [37m-         -Djava.endorsed.dirs=\"$JBOSS_ENDORSED_DIRS\" \[0m
192.168.33.135     [37m-         -classpath \"$JBOSS_CLASSPATH\" \[0m
192.168.33.135     [37m+      "$JAVA" $JAVA_OPTS \[0m
192.168.33.135     [37m+         -Djava.endorsed.dirs="$JBOSS_ENDORSED_DIRS" \[0m
192.168.33.135     [37m+         -classpath "$JBOSS_CLASSPATH" \[0m
192.168.33.135     [37m          org.jboss.Main "$@"[0m
192.168.33.135     [37m       JBOSS_STATUS=$?[0m
192.168.33.135     [37m    else[0m
192.168.33.135     [37m       # Execute the JVM in the background[0m
192.168.33.135     [37m-      eval \"$JAVA\" $JAVA_OPTS \[0m
192.168.33.135     [37m-         -Djava.endorsed.dirs=\"$JBOSS_ENDORSED_DIRS\" \[0m
192.168.33.135     [37m-         -classpath \"$JBOSS_CLASSPATH\" \[0m
192.168.33.135     [37m-         org.jboss.Main "$@" "&"[0m
192.168.33.135     [37m+      "$JAVA" $JAVA_OPTS \[0m
192.168.33.135     [37m+         -Djava.endorsed.dirs="$JBOSS_ENDORSED_DIRS" \[0m
192.168.33.135     [37m+         -classpath "$JBOSS_CLASSPATH" \[0m
192.168.33.135     [37m+         org.jboss.Main "$@" &[0m
192.168.33.135     [37m       JBOSS_PID=$![0m
192.168.33.135     [37m       # Trap common signals and relay them to the jboss process[0m
192.168.33.135     [37m       trap "kill -HUP  $JBOSS_PID" HUP[0m
192.168.33.135     [37m@@ -266,34 +277,27 @@[0m
192.168.33.135     [37m       trap "kill -QUIT $JBOSS_PID" QUIT[0m
192.168.33.135     [37m       trap "kill -PIPE $JBOSS_PID" PIPE[0m
192.168.33.135     [37m       trap "kill -TERM $JBOSS_PID" TERM[0m
192.168.33.135     [37m-      if [ "x$JBOSS_PIDFILE" != "x" ]; then[0m
192.168.33.135     [37m-        echo $JBOSS_PID > $JBOSS_PIDFILE[0m
192.168.33.135     [37m-      fi[0m
192.168.33.135     [37m       # Wait until the background process exits[0m
192.168.33.135     [37m       WAIT_STATUS=128[0m
192.168.33.135     [37m       while [ "$WAIT_STATUS" -ge 128 ]; do[0m
192.168.33.135     [37m          wait $JBOSS_PID 2>/dev/null[0m
192.168.33.135     [37m          WAIT_STATUS=$?[0m
192.168.33.135     [37m-         if [ "$WAIT_STATUS" -gt 128 ]; then[0m
192.168.33.135     [37m-            SIGNAL=`expr $WAIT_STATUS - 128`[0m
192.168.33.135     [37m-            SIGNAL_NAME=`kill -l $SIGNAL`[0m
192.168.33.135     [37m-            echo "*** JBossAS process ($JBOSS_PID) received $SIGNAL_NAME signal ***" >&2[0m
192.168.33.135     [37m-         fi[0m
192.168.33.135     [37m+         if [ "${WAIT_STATUS}" -gt 128 ]; then[0m
192.168.33.135     [37m+            SIGNAL=`expr ${WAIT_STATUS} - 128`[0m
192.168.33.135     [37m+            SIGNAL_NAME=`kill -l ${SIGNAL}`[0m
192.168.33.135     [37m+            echo "*** JBossAS process (${JBOSS_PID}) received ${SIGNAL_NAME} signal ***" >&2[0m
192.168.33.135     [37m+         fi          [0m
192.168.33.135     [37m       done[0m
192.168.33.135     [37m-      if [ "$WAIT_STATUS" -lt 127 ]; then[0m
192.168.33.135     [37m+      if [ "${WAIT_STATUS}" -lt 127 ]; then[0m
192.168.33.135     [37m          JBOSS_STATUS=$WAIT_STATUS[0m
192.168.33.135     [37m       else[0m
192.168.33.135     [37m          JBOSS_STATUS=0[0m
192.168.33.135     [37m-      fi[0m
192.168.33.135     [37m-      if [ "$JBOSS_STATUS" -ne 10 ]; then[0m
192.168.33.135     [37m-            # Wait for a complete shudown[0m
192.168.33.135     [37m-            wait $JBOSS_PID 2>/dev/null[0m
192.168.33.135     [37m-      fi[0m
192.168.33.135     [37m+      fi      [0m
192.168.33.135     [37m    fi[0m
192.168.33.135     [37m    # If restart doesn't work, check you are running JBossAS 4.0.4+[0m
192.168.33.135     [37m    #    http://jira.jboss.com/jira/browse/JBAS-2483[0m
192.168.33.135     [37m    # or the following if you're running Red Hat 7.0[0m
192.168.33.135     [37m-   #    http://developer.java.sun.com/developer/bugParade/bugs/4465334.html[0m
192.168.33.135     [37m+   #    http://developer.java.sun.com/developer/bugParade/bugs/4465334.html   [0m
192.168.33.135     [37m    if [ "$JBOSS_STATUS" -eq 10 ]; then[0m
192.168.33.135     [37m       echo "Restarting JBoss..."[0m
192.168.33.135     [37m    else[0m
192.168.33.135     [32m- change owner from 'root' to 'jboss'[0m
192.168.33.135     [32m- change group from 'root' to 'jboss'[0m
192.168.33.135     [32m- restore selinux security context[0m
192.168.33.135 [0m  * template[/etc/init.d/jboss] action create
192.168.33.135     [32m- create new file /etc/init.d/jboss[0m
192.168.33.135     [32m- update content in file /etc/init.d/jboss from none to 30a2ce[0m
192.168.33.135     [37m--- /etc/init.d/jboss	2016-09-15 15:41:48.828209127 +0000[0m
192.168.33.135     [37m+++ /etc/init.d/.chef-jboss20160915-23237-18d6gpn	2016-09-15 15:41:48.828209127 +0000[0m
192.168.33.135     [37m@@ -1 +1,46 @@[0m
192.168.33.135     [37m+#!/bin/bash[0m
192.168.33.135     [37m+#jboss        Startup script for the JBoss Java Application Server[0m
192.168.33.135     [37m+#[0m
192.168.33.135     [37m+# chkconfig: - 85 15[0m
192.168.33.135     [37m+# description: The JBoss Java Application Server [0m
192.168.33.135     [37m+#[0m
192.168.33.135     [37m+# processname: jboss[0m
192.168.33.135     [37m+[0m
192.168.33.135     [37m+JBOSS_HOME="/opt/jboss-6.1.0.Final"[0m
192.168.33.135     [37m+[0m
192.168.33.135     [37m+start()[0m
192.168.33.135     [37m+{[0m
192.168.33.135     [37m+echo "Starting jboss"[0m
192.168.33.135     [37m+  su -l jboss -c "/opt/jboss-6.1.0.Final/bin/run.sh -b  > /dev/null 2> /dev/null &"[0m
192.168.33.135     [37m+}[0m
192.168.33.135     [37m+[0m
192.168.33.135     [37m+stop()[0m
192.168.33.135     [37m+{[0m
192.168.33.135     [37m+echo "Stopping jboss"[0m
192.168.33.135     [37m+  su -l jboss -c "/opt/jboss-6.1.0.Final/bin/shutdown.sh -S"[0m
192.168.33.135     [37m+}[0m
192.168.33.135     [37m+[0m
192.168.33.135     [37m+restart()[0m
192.168.33.135     [37m+{[0m
192.168.33.135     [37m+stop[0m
192.168.33.135     [37m+sleep 20[0m
192.168.33.135     [37m+start[0m
192.168.33.135     [37m+}[0m
192.168.33.135     [37m+[0m
192.168.33.135     [37m+case "$1" in[0m
192.168.33.135     [37m+	start)[0m
192.168.33.135     [37m+		start[0m
192.168.33.135     [37m+;;[0m
192.168.33.135     [37m+	stop)[0m
192.168.33.135     [37m+		stop[0m
192.168.33.135     [37m+;;[0m
192.168.33.135     [37m+	restart)[0m
192.168.33.135     [37m+		restart[0m
192.168.33.135     [37m+;;[0m
192.168.33.135     [37m+	*)[0m
192.168.33.135     [37m+[0m
192.168.33.135     [37m+echo "Usage: jboss {start|stop|restart}"[0m
192.168.33.135     [37m+exit 1[0m
192.168.33.135     [37m+esac[0m
192.168.33.135     [37m+exit 0[0m
192.168.33.135     [32m- change mode from '' to '0755'[0m
192.168.33.135     [32m- change owner from '' to 'root'[0m
192.168.33.135     [32m- change group from '' to 'root'[0m
192.168.33.135     [32m- restore selinux security context[0m
192.168.33.135 [0m  * directory[/opt/jboss-6.1.0.Final/server/default/logs] action create
192.168.33.135     [32m- create new directory /opt/jboss-6.1.0.Final/server/default/logs[0m
192.168.33.135     [32m- change mode from '' to '0755'[0m
192.168.33.135     [32m- change owner from '' to 'jboss'[0m
192.168.33.135     [32m- change group from '' to 'jboss'[0m
192.168.33.135     [32m- restore selinux security context[0m
192.168.33.135 [0m  * execute[jboss_home_access] action run
192.168.33.135     [32m- execute chown -R jboss:jboss /opt/jboss-6.1.0.Final[0m
192.168.33.135 [0m  * service[jboss] action enable
192.168.33.135     [32m- enable service service[jboss][0m
192.168.33.135 [0m  * service[jboss] action start
192.168.33.135     [32m- start service service[jboss][0m
192.168.33.135 [0m[0m
192.168.33.135 Running handlers:[0m
192.168.33.135 Running handlers complete
192.168.33.135 [0mChef Client finished, 17/24 resources updated in 03 minutes 04 seconds[0m
